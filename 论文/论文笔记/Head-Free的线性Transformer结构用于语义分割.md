https://arxiv.org/pdf/2301.04648.pdf

https://github.com/dongbo811/AFFormer

作者提出一种无头轻量级语义分割特定架构，使用金字塔结构降低分辨率以探索语义并降低计算成本，并采用并行架构，利用原型表示作为特定的可学习局部描述，取代解码器并在高分辨率特征上保留丰富的图像语义。此外，对像素嵌入特征和局部描述特征采用异构算子，并构建了一个复杂度为 O（n）的轻量级自适应频率滤波器作为原型学习，该模块的核心由频率相似核，动态低通滤波器和动态高通滤波器组成，分别从强调重要频率成分和动态过滤频率的角度捕捉有利于语义分割的频率信息。

![[Pasted image 20240313151411.png]]

AFFormer 的总体框架，首先对 patch embedding 后的特征进行聚类，得到原型特征 G，从而构建一个并行网络结构，其中包含两个异构算子，基于 transformer 的模块作为原型学习以捕获 G 中有利的频率分量，从而产生原型表示 G'，最后，G'由基于 CNN 的像素描述符恢复，为下一阶段生成特征。

==并行异构架构==
语义解码器将编码器获得的图像语义传播到每个像素，并恢复下采样中丢失的细节，一种直接的替代方法是在高分辨率特征中提取图像语义，但他会引入大量计算。这里提出一种用原型语义描述像素语义信息的新策略，首先初始化一个网格作为图像原型，将网格中的每个点作为局部簇中心，然后在其区域内进行加权初始化，接着使用基于 transformer 的模块作为原型学习来更新每个聚类中心。

==自适应频率滤波器==
频率表示可以作为学习类别间差异的新范式，在网格中提取更多的有益频率有助于区分每个聚类的属性，直接的方法是将空间域特征通过傅里叶变化转换成频谱特征，在频域使用简单的 mask filter 增强或减弱频谱的每个频率分量的强度，然后将提取的频率特征通过傅里叶逆变换转换到空间域。
![[Pasted image 20240313152859.png]]

