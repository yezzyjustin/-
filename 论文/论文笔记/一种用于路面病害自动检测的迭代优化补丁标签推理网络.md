
An Iteratively Optimized Patch Label Inference Network for Automatic Pavement Disease Detection
https://ieeexplore.ieee.org/abstract/document/9447759

我们提出了一种新的深度学习框架，称为迭代优化补丁标签推理网络 (IOPLIN)，用于自动检测各种路面疾病，而不仅仅局限于特定的疾病，如裂缝和坑洞。通过期望最大化启发补丁标签蒸馏 (EMIPLD)策略，IOPLIN 可以只使用图像标签进行迭代训练，并通过从路面图像中推断出补丁的标签来很好地完成这项任务。与 GoogLeNet 和 EfficientNet 等最先进的单分支 CNN 模型相比，IOPLIN 具有许多令人满意的特性。它能够处理不同分辨率的图像，并充分利用图像信息，特别是对于高分辨率的图像，因为 IOPLIN 从未修改的图像补丁中提取视觉特征，而不是从调整大小的整个图像中提取。此外，在训练阶段，该算法可以在不使用任何先验定位信息的情况下，对路面破损进行粗略定位。为了更好地评估该方法在实践中的有效性，我们构建了一个大规模的沥青路面病害检测数据集 CQU-BPDD，该数据集由 60,059 张不同时间、不同区域的高分辨率路面图像组成。该数据集的大量结果表明，在自动路面疾病检测方面，IOPLIN 优于最先进的图像分类方法。IOPLIN 的源代码在https://github.com/DearCaat/ioplin上发布。

几十年来，有许多令人印象深刻的研究从计算机视觉的角度解决了不同的路面疾病分析问题。然而，现有的路面病害检测方法主要是针对特定路面病害进行检测，多为裂缝或坑洞[2]，[3]，[4]，[5]。此外，许多所谓的路面病害检测工作也模糊地定义了任务。其中大部分实际上应该归为路面裂缝分割[6]、[7]、[8]、[9]、[10]和定位[11]、[12]、[13]，与实际路面病害检测完全不同。在本文中，我们所关注的路面病害检测任务与这些任务相关，但又有很大的不同。我们打算根据路面图像来判断是否有疾病。我们打算检测的路面病害不仅限于裂缝和坑洞，还包括其他一般的病害，如修补和裂缝浇注。我们将该任务命名为路面病害自动检测，这可以看作是路面裂缝检测的一种推广。该任务也是路面裂缝分割的重要前置步骤，是路面裂缝定位的核心步骤。虽然这种任务可以被认为是一个典型的路面图像二值分类问题，但它是非常具有挑战性的，因为路面成像存在光照不均匀、色差、背景道路标记以及各种病害 (如裂缝、坑洞、侵蚀坑及其混合物)外观的高度多样性。

病变区域通常只是整个路面图像的很小一部分。在这种情况下，上述基于全局的方法可能更容易受到噪声和背景变化的阻碍。因此，我们提出了一种新的基于局部的深度学习框架，称为迭代优化补丁标签推理网络(IOPLIN)，以解决自动路面疾病检测问题。

在 IOPLIN 中，路面图像被分割成几十个小块，然后将一个 effentnet[16]作为一个小块标签推理网络 (Patch Label Inference Network，简称 PLIN)来推断小块的标签。最后，通过对路面图像的推断补丁标签进行最大池化，得到路面图像的检测结果。这种方法的主要障碍是只有图像级别的标签可用。为了解决这一问题，我们提出了期望最大化启发贴片标签蒸馏 (EMIPLD)策略，仅基于图像标签迭代逐步优化 PLIN。与基于卷积 cnn 的路面疾病检测方案不同，IOPLIN 不仅在图像层面提供了更好的检测结果，而且通过 EMIPLD 以弱监督的方式对路面图像中的疾病进行了粗略的定位。

为了评估我们工作的有效性，我们引入了一个名为 CQU-BPDD 的新型大规模沥青路面疾病检测数据库，该数据库由 60,059 张高分辨率路面图像组成，涉及七种不同的疾病和一个正常的路面。这些图像是由中国南方不同地区的车载摄像头自动捕获的。在该数据集上的大量实验结果验证了与最先进的 CNN 算法相比，IOPLIN 的有效性和优越性。

主要贡献总结如下:
•据我们所知，我们是第一个正式定义和系统研究路面疾病自动检测任务的工作，而不仅仅局限于裂缝和坑洞等特定疾病。

•我们发布了一个全新的、大规模的路面疾病自动检测数据集，该数据集来自真实场景，涉及各种疾病。所有现有的路面疾病数据集仅包含数百或数千个样本，而我们的数据集包含 6 万多张高分辨率路面图像，涉及更多类型的疾病。

•我们提出了一种新颖的、基于深度学习的自动路面疾病方法，称为迭代优化补丁标签推理网络 (IOPLIN)，它不仅可以充分利用任何分辨率图像的信息来检测路面疾病，而且可以仅根据图像标签粗略地定位受损位置。

•我们进行了大量的实验，系统地和经验地比较了最近最先进的 CNN 方法在自动路面疾病检测中的性能，并验证了我们的工作不仅在性能上，而且在鲁棒性和跨数据泛化方面都优于它们。

**Image-based Pavement Disease Analysis**
传统的路面病害分析方法主要基于底层图像分析、手工特征和经典分类器[17]、[18]、[19]、[20]、[7]。例如，Shi 等[6]提出了一种名为 CrackForest 的随机结构森林，该森林与积分通道特征相结合，用于道路裂缝自动检测。在[7]中，提出了一种由多个定向 Gabor 滤波器组成的滤波器组来检测道路裂缝。Pan 等[2]利用 KNN、SVM、随机森林和神经网络，基于无人机获取的图像对路面裂缝和坑洞进行了识别。

受深度学习在广泛应用中取得显著成功的启发，越来越多的研究人员应用先进的深度学习方法来解决这些任务[21]，[3]，[4]，[22]。Zhang 等[8]利用卷积神经网络 (Convolutional Neural Networks, CNN)检测裂缝点对路面裂缝进行分割。在[4]中，使用 ImageNet 预训练的 VGG-16 DCNN 将路面图像分为“裂缝”和“非裂缝”。Xia[23]采用 Single Shot multibox Detector (SSD)[24]网络对路面病害进行定位。也有研究者利用一些知名的目标检测框架，如 YOLO v 2、Faster RCNN、RetinaNet 等来定位路面病害[11]、[12]、[13]、[25]。Fan 等[3]提出了一种新的道路裂缝自动检测系统。在该系统中，首先使用 CNN 来判断路面图像是否含有裂缝，然后在经过双边滤波器平滑的图像基础上，提出一种自适应阈值分割方法来分割裂缝。

综上所述，上述工作的任务可分为三类: 路面裂缝分割[6]、[7]、[8]、[9]、[10]; 路面裂缝定位[11]、[12]、[13]; 路面具体破损检测[2]、[3]、[4]。显然，一般路面病害检测并不局限于特定病害的检测，目前还没有系统的研究。此外，现有的路面病害数据集，如裂缝森林数据集 (Crack Forest Dataset, CFD)[6]、CrackTree 200[26]、Crack 500[9]等，主要用于路面裂缝分割。这些数据集通常包含数百或数千个样本，仅涉及病变图像，不能直接应用于研究路面疾病检测。

在本文中，我们试图开发一种新的深度学习方法，称为迭代优化补丁标签推理网络 (IOPLIN)，用于自动检测路面疾病，而不仅仅局限于某些特定的疾病。为支持自动路面的研究，发布了大规模路面病害图像数据集 CQU-BPDD 疾病检测。CQU-BPDD 数据集是一个更具挑战性的路面图像数据集，它包含 60,059 张高分辨率路面图像，涉及七种不同类型的路面疾病和正常情况。

**Problem Formulation and Overview**
设 Ii 为与二元标签 yi 相关联的路面图像，该标签表示是否存在疾病。路面病害自动检测本质上是一个二值图像分类任务，目的是推导出一个检测器 D: Ii - yi 易将路面图像分为“病态”或“正常”。

为了解决自动路面疾病检测任务，我们提出了一种新的深度学习方法，称为迭代优化补丁标签推理网络 (IOPLIN)。在 IOPLIN 中，路面图像首先通过对比度有限自适应直方图均衡化 (CLAHE)进行预处理[44]，以抑制光照不均匀的负面影响。处理后的图像将被进一步分割成小块，并训练一个小块标签推理网络 (Patch Label Inference Networks, PLIN)来推断小块标签。最后，对路面图像贴片标签进行最大池化，得到路面图像标签。我们方法的核心是 PLIN。然而，PLIN 不能直接得到很好的训练，因为只有图像标签可用，而每个图像的 patch 标签在训练阶段是不可用的。为了克服这一困难，我们提出了期望最大化启发贴片标签蒸馏 (EMIPLD)策略，通过合理初始化贴片标签来迭代优化 PLIN 训练。在接下来的小节中，我们将详细介绍我们的方法。