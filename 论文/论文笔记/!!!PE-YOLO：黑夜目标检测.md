https://github.com/XiangchenYin/PE-YOLO

	在暗光条件下的目标检测也可以看作是域自适应问题。一些研究者采用对抗学习将模型从正常光到暗光进行转换。但是他们关注的是数据分布的匹配，忽略了暗光图像中所包含的潜在信息。近几年，一些研究者提出了使用可微分图像处理 (DIP)模块来增强图像，并以端到端的方式训练检测器。然而，DIP 是传统的方法，如白平衡，对图像的增强效果有限。
	为了解决以上问题，本文作者提出了一种金字塔增强网络 (PENet)，用于增强暗光图像并捕获有关目标的潜在信息。作者将 PENet 与 YOLOv 3 结合，构建了一个名为 PE-YOLO 的端到端的暗目标检测框架。在 PENet 中，作者首先使用拉普拉斯金字塔将图像分解为多个不同分辨率的组成部分。在金字塔的每个尺度上，作者提出了细节处理模块 (DPM)和低频增强滤波器 (LEF)来增强这些组成部分。
	DPM 由上下文分支和边缘分支组成，上下文分支通过捕获远距离依赖关系全局增强组成部分，而边缘分支增强组成部分的纹理。LEF 使用动态低通滤波器来获取低频语义信息，防止高频噪声以丰富特征信息。作者在模型训练过程中只使用正常的检测损失来简化训练过程，无需对图像进行清晰的标注。

![[Pasted image 20240327145203.png]]

PENet 通过拉普拉斯金字塔将图像分解成不同分辨率的组件，通过提出的细节处理模块 DPM 和低频增强滤波器 LEF 来增强每个尺度的组件。

假设图像 I∈R 作为输入，作者使用高斯金字塔获取不同分辨率的子图像：
G (x)=Down (Gaussian (x))
其中，Doun 表示下采样，Gaussian 表示高斯滤波器，高斯核的大小为 5 x 5。在每个高斯金字塔操作后，图像的宽度和高度减半，这意味着分辨率是原始图像的 1/4。显然，高斯金字塔的下采样操作是不可逆的。为了在上采样后恢复原始的高分辨率图像，需要恢复丢失的信息，这些丢失的信息构成了拉普拉斯金字塔的组件。拉普拉斯金字塔的定义如下:
${{L}_{i}}={{G}_{i}}-{{U}_{p}}({{G}_{i+1}})$
Li 表示拉普拉斯金字塔的第 i 层，Gi 表示高斯金字塔的第 i 层，Up 表示双线性上采样操作。

作者通过拉普拉斯金字塔获得了不同尺度的 4 个组件，如图所示。作者发现拉普拉斯金字塔从底部到顶部更关注全局信息，而从顶部到底部更关注局部细节。它们都是在图像下采样过程中丢失的信息，也是作者 PENet 增强的目标。作者通过细节处理模块 (DPM)和低频增强滤波器 (LEF)来增强这些组件，DPM 和 LEF 的操作是并行的。

![[Pasted image 20240327145959.png]]

**细节信息增强**
作者提出了一个细节处理模块 DPM 来增强拉普拉斯金字塔中的组件，他由上下文分支和边缘分支组成。
![[Pasted image 20240327150742.png]]
上下文分支通过捕捉远程依赖性来获取上下文信息，并全局增强组件，边缘分支使用两个不同方向的 sobel 算子来计算图像梯度，获取边缘并增强组件的纹理。

**低频增强滤波器**
在每个尺度的分量中，低频分量包含了图像中的大部分语义信息，他们是检测器预测的关键信息，为了丰富重建图像的语义信息，作者提出了低频增强滤波器 LEF 来捕捉组成部分中的低频信息。
![[Pasted image 20240327151316.png]]

假设组成部分 feRhxwx 3，作者首先通过一个卷积层将其转换为 feRhxwx 32。作者使用动态低通滤波器来捕捉低频信息，并且使用平均池化进行特征滤波，只允许低于截止频率的信息通过。

不同语义的低频阈值是不同的。考虑到 Inception 的多尺度结构，作者使用大小为 1 x 1、2 x 2、3 x 3、6 x 6 的自适应平均池化，并在每个尺度末尾使用上采样来恢复特征的原始大小。不同卷积核大小的平均池化形成了低通滤波器。作者通过通道分离将 f 划分为 4 个部分，即{f, f, f, f}。每个部分使用不同大小的池化进行处理，具体描述如下:
![[Pasted image 20240327151442.png]]

