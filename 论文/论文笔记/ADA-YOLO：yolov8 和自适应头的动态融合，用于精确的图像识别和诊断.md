ADA-YOLO：Dynamic fusion of yolov8 and adaptive heads for precise image fetection and diagnosis

医学影像中的目标检测传统方法依赖于手工特征和机器学习算法，如模板匹配，边缘检测器，活性形状模型和变形模型，受到复杂结构，类间变异性以及有限泛化能力的影响。

为了更好地表述类别不平衡问题，将 DFL 集成，其是一种增强型的 Focal Loss，通过根据样本的类别为其分配不同的权重并提供一个可调整的超参数的有效方法来处理不平衡的数据集。

DFL 的数学表达式如下：
$DFL({{\text{p}}_{t}})=-{{\alpha }_{t}}{{(1-{{p}_{t}})}^{\gamma }}\log ({{p}_{t}})$
Pt 表示模型预测目标为正样本的概率，${{\alpha }_{t}}$ 表示类别 t 的权重，$\gamma$ 是可调整的超参数，${{\alpha }_{t}}$ 使用作为加权因子有助于缓解类别不平衡的影响，通过为代表性较弱的类别分配更高的权重。

为了解决样本不平衡的问题，${{\alpha }_{t}}$ 设置为样本数的倒数，即
${{\alpha }_{\text{t}}}=\frac{\sum\nolimits_{i=1}^{n}{{{w}_{i}}}}{{{w}_{t}}}$
Wi 表示第 i 个样本的权重，n 是总的样本数量，wt 是类别 t 的权重。此外 DFL 公式中的 $\gamma$ 调整了容易分类样本和难以分类样本的权重，当其大于0时，容易分类样本的权重降低，而难以分类样本的权重增加。

YOLO 算法的损失函数主要包含分类损失和定位损失，还引入了预测目标存在的置信度分数，并将其对应的置信度损失添加到损失函数中去，总的损失为：
![[Pasted image 20240313162535.png]]
