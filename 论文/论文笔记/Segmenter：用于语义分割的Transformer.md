https://arxiv.org/abs/2105.05633

Https://github.com/rstrudel/segmenter

图像分割在单个图像块的层次上通常是模糊的，需要上下文信息才能达成一致。![[Pasted image 20240313144221.png]] Encoder
1）一幅图像 x 被分割成一系列补丁 x=[x 1,..., xn]，每一块补丁扁平化成一维向量
2）然后线性投影到补丁嵌入以产生补丁嵌入序列 x 0=[Ex 1,..., Exn]，为了捕获位置信息，将可学习的位置嵌入 pos=[pos 1,..., posn]添加到补丁序列中，以获得令牌的结果输入序列 z 0=x 0+pos
3）由 L 层组成的 transformer 编码器将具有位置编码信息的嵌入式补丁的输入序列 z 0 =[z 0,1,..., z 0, n]映射到 zL= [zL, 1,..., zL, n]，这是一个上下文编码序列，包含解码器使用的丰富语义信息

Decoder
将补丁编码序列 zL 解码为分割图 s，解码器学习将来自编码器的补丁级编码映射到补丁级类分数
Linear）将逐点线性层应用于补丁编码 zL，以产生补丁级类标记 Z-lin，然后将序列重塑为 2 D 特征图 S-lin，并对其进行双上采样，以达到原始图像大小 s，然后在维度上应用 softmax 以获得最终的分割图
Mask Transformer）对于基于 Transformer 的解码器，我们引入了一组 K 个可学习的类嵌入 cls=[cls 1,..., clsk]，其中 k 是类的数量，每个类嵌入都是随机初始化的，并分配给单个语义类，它将用于生成类掩码，类嵌入 cls 由解码器与补丁编码 zl 联合处理