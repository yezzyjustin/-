SMINet: Semantics-aware multi-level feature interaction network for surface
Defect detection

**Abstract**
为了提高产品质量，许多基于显著性的表面缺陷检测方法被用于工业生产、建筑耗材、道路建设等领域。然而，现有的显著目标检测方法不仅消耗了大量的计算资源，而且无法满足企业对检测效率的要求。为此，本文提出了一种轻量级的语义感知多级特征交互网络 (SMINet)来解决上述问题。在编码器阶段，我们在跨层特征融合 (cross-layer feature fusion, CFF)模块中集成多个相邻级别的特征，以缓解多尺度特征之间的差异。在解码器阶段，我们首先使用语义感知特征提取 (SFE)模块来挖掘嵌入在高级特征中的位置线索。然后，我们引入了基于注意机制的细节感知上下文注意 (DCA)模块，以恢复更多的空间细节。在四个表面缺陷数据集上进行的大量实验验证了我们的 SMINet 优于现有的最先进的方法。
**Introduction**
缺陷检测作为显著性检测的一个分支，其目的是定位和突出缺陷区域，广泛应用于各种生产活动中，如钢铁制造、道路养护、设备检修等。随着计算机视觉的发展，近年来出现了基于机器视觉的各种类型的任务，如物体检测 (Dong et al .， 2021 b; Zhang 等，2022; Zhou et al .， 2022)，目标跟踪 (Hare et al .， 2015; Lu et al, 2019)，以及图像分类 (He et al, 2019; Park and Yang, 2019))，以及缺陷检测 (Zhou et al .， 2021 b; Li et al .， 2019)广泛的应用场景吸引了众多研究者的关注。

在过去的二十年中，传统的基于计算机视觉的缺陷检测方法主要依赖于手工制作的线索 (即颜色、对比度和纹理)，已经成为许多工业场景中的主要方法 (Sharifzadeh 等，2008)，并逐渐应用于民用领域 (Tajeripour 等，2007)。例如，在 Ng (2006)中，Fang 等人提出了一种改进的 Otsu 方法，通过自动选择单峰分布和双峰分布的最优阈值进行缺陷检测。Mak 等人 (2009)利用预训练 Gabor 小波网络提取织物的纹理特征，便于构造结构元素。此外，Ngan 等人 (2005)提出了一种由金图像减法和小波预处理金图像减法组成的用于图案织物缺陷检测的自动化检测方法。传统的检测方法虽然在效率和精度上都有一定的提高，但在处理低质量的输入图像 (即低对比度、低分辨率)时，这些方法只提取了浅层特征，忽略了深层特征中嵌入的位置和细节信息，导致缺陷区域分割不完全。

随着深度学习的快速发展，该技术已成为应对各种视觉任务的主流方式。利用卷积神经网络 (CNN)提取深层特征的能力，随着卷积层的加深，各种信息被揭示出来，其中高层的语义信息有利于目标的定位，低层的判别信息有助于细节区域的恢复。因此，基于 cnn 的缺陷检测方法已经成为一个很有前途的研究领域，它取代了传统的方法，进一步推动了检测结果的准确性。例如，Li 和 Xi (2021)提出了一种新的缺陷检测网络，该网络由判断图像是否含有缺陷的二值分类网络和检测缺陷的检测网络组成，提高了检测速度。Cheng and Yu (2020)利用基于搜索的锚点优化来提高准确性，并提出了一种新的渠道注意机制来减少信息丢失。此外，引入自适应空间特征融合模块，实现了深、浅特征的有效融合。Wang 和 Wu (2021)采用跳跃层连接模块和金字塔特征融合模块，提高了类内差异大、类间相似性高的缺陷图像的性能，解决了检测速度低的问题。在最近的工作中 (Konovalenko 等人，2022 a, b)， Konovalenko 研究了光照水平对轧制带材的影响，并提出了一种 U-net 架构来检测检测。

尽管基于 cnn 的缺陷检测方法具有突出的性能，但仍有许多问题需要解决。首先，利用编码器的多尺度特征进行显著性检测是至关重要的。然而，现有的基于全卷积网络 (FCN)的方法大多直接将多尺度特征从主干馈送到解码器，并通过上采样和一系列卷积和池化操作引入的特征分辨率的不断降低，简单地以自下而上的方式对这些特征进行整合，导致多尺度特征之间存在明显的差距。在从低分辨率到高分辨率的转换过程中，缺陷区域信息被稀释，大大降低了检测结果的准确性。虽然现有的一些方法 (Pang et al, 2020)在下一阶段之前融合相邻的两层或三层特征，在一定程度上减少了信息稀释的影响，但这些方法没有考虑到更多的跨层特征之间的连接，导致分辨率差异较大的特征之间的信息交互受到限制。其次，挖掘嵌入在高级特征中的有效语义信息成为确定 SOD 中目标位置的关键组成部分。现有的许多方法 (Zhai et al .， 2021)在高级特征背后采用了自然空间金字塔池 (ASPP) (Chen et al .， 2017)，利用具有不同接受场的卷积层进一步提取丰富的语义。但是，ASPP 产生了网格伪影，增加了参数的数量，降低了计算速度。第三，与高层特征相比，规模较大的低层特征具有更多的空间结构细节，但也含有过多的噪声。许多以前的方法 (Yang et al .， 2019; Chen et al .， 2019)通过特征金字塔的方式直接从编码器中集成底层特征，但在处理低对比度缺陷时无法滤除背景噪声。

为了解决上述问题，我们提出了一种新的缺陷检测网络 SMINet，该网络在检测不同类型的表面缺陷方面取得了显著的性能提升。首先，为了尽可能消除尺度差异导致的特征信息差异，避免自下而上连接带来的信息稀释，我们提出了一种跨层特征融合 (cross-layer feature fusion, CFF)模块。具体而言，如图 2 所示的 CFF 模块采用跨层融合策略，将多个相邻层的特征进行融合，体现了多尺度特征之间的互补性。因此，对于底层特征，它可以最大程度地与其他尺度特征融合，同时保留更详细的信息。此外，将高阶特征与其相邻特征相结合可以避免低阶噪声的干扰，增强高阶语义线索。通过引入 CFF 模块，可以保证多尺度信息在不同层间传输过程中的完整性。其次，与常用的 ASPP 模块不同，我们引入了语义感知特征提取 (SFE)模块，如图 3 所示，该模块包括两个阶段 (特征交互 (FI)和特征细化 (FR))来挖掘语义信息。第一阶段，采用类 gcn 结构实现两个特征之间的关联，探索语义关系在每个像素和每个通道之间。之后，阶段二将 FI 的语义感知特征聚合，并利用注意机制实现细化。第三，在利用跨层特征融合模块 (CFF)之后，虽然低层特征包含更详细的结构线索，但也引入了许多不相关的噪声信息。

因此，我们在两个低级特征之后部署了细节感知上下文注意 (DCA)模块，如图 4 所示，该模块利用了不同通道特征的不同注意机制。最后，为了证明我们提出的 SMINet 的卓越性能，我们在四个公共数据集上进行了广泛的实验，可视化和定量结果证明我们的方法在有效性和优越性上优于其他最先进的方法。

本文的贡献可以概括为以下几点: 
1. 提出了一种新的表面缺陷显著性检测方法 smenet，该方法由跨层特征融合 (CFF)模块、语义感知特征提取 (SFE)模块和细节感知上下文注意 (DCA)模块组成。

2. 为了增强多尺度特征的互补性，降低自下而上连接带来的信息稀释影响，提出了 CFF 模块。如图 5 所示的可视化结果也验证了 CFF 模块的有效性。

3. 为了提取嵌入在高级特征中的语义线索，我们提出了一个由特征交互和特征细化组成的 SFE 模块，该模块采用类 gcn 结构和通道关注机制。

4. 我们提出了 DCA 模块，该模块利用两种注意策略过滤掉 CFF 模块引入的冗余信息。

**Related work**
本文简要介绍了突出目标检测、表面缺陷检测和基于多层次融合的检测方法的相关工作。

2.1. 显著性目标检测
已被应用于各种场景 (遥感图像、医学图像、视频)，并取得了良好的效果。近年来，人们提出了许多显著性模型。例如，Wei 等人 (2012)提出了一种测地线显着性，该显着性利用边界优先和连通性优先，更多地关注背景而不是前景。Ju 等人 (2014)根据点在背景中的突出程度来检测点的显著性，并利用深度和位置先验进行细化。最近，基于深度学习的显著性方法已经验证了它们的有效性。Zhang 等 (2020 a)提出了一种新的显著性检测网络，该网络融合了注意机制，并探索了上下文感知机制，以捕获长期语义上下文关系。Zhang 和 Ma (2021)提出了一种结合弱监督学习和完全监督学习优点的 SOD 方法，其中使用伪标签生成方法来减少大规模像素级标注的需求。此外，构建了反馈显著性分析网络，生成逐像素标签。Wang 等 (2021)提出了一种由跨任务特征子网、三维病变子网和分类子网组成的联合学习网络，以应对医疗资源的短缺。Fan 等 (2020)提出了一种自动检测网络，其中使用并行部分解码器集成高级特征，并利用两种注意机制增强感染区域的表征。目前，SOD 方法逐渐应用到视频领域。Wang 等人 (2017)提出了一种新的数据增强技术，使网络学习更多样化的显著性信息，并从帧对中捕获时间显著性。Ji et al (2020)开发了一种用于视频显著性目标检测的新型编码器-解码器暹罗框架，并设计了自注意和交叉注意模块的组合，以保持时空显著性相关性.

2.2. 表面缺陷检测
得益于计算机视觉的发展，基于显著性的缺陷检测方法已经取得了巨大的进展。Quintana 等人(2015)开发了一种更简单的检测系统，该系统由硬肩检测、单元候选建议和裂纹分类组成，将图像分割成小网格单元并提取纹理特征。Yu 等 (2018)提出了一种从三个层次 (即子图像级、区域级和像素级)从粗到精的模型来区分缺陷区域和噪声。近年来，深度学习被广泛应用于表面缺陷检测。Pandiyan 等 (2019)提出了一种编码器-解码器卷积神经网络，采用改进的 VGG-16 实现焊缝去除状态的语义分割。Luo 等人 (2021)提出了一种解耦的两阶段目标检测框架，其中设计了多层聚合块和局部非局部块进行定位和分类。Song 等 (2020)提出了一种新的检测方法，该方法采用信道加权块和残差解码器块来整合多层次特征。此外，采用一维滤波器残差细化结构对粗特征进行细化。Niu 等 (2021)利用自适应金字塔图和变异残差捕捉相关描述，增强异常缺陷的检测，提高了铁路缺陷检测的鲁棒性。Zheng 等(2021)设计了集成多尺度、多层次特征的端到端残差 u 型结构框架，并引入 s 坐标关注模块提取有用特征。此外，成像设备的发展也为缺陷检测提供了多种可能性。Zhang 等 (2020 b)利用彩色线扫描相机、条形灯和位移平台捕捉钢轨表面缺陷图像。Zhang 等 (2020 d)将柔性涡流阵列探头与直角坐标机器人相结合，对曲面缺陷进行成像。

**3.建议的框架** 
**3.1概述拟议的 SMINet**
本文提出了一种新的缺陷检测方法，如图 1 所示，该方法由三个关键组件组成，即跨层特征融合 (CFF)模块、语义感知特征提取 (SFE)模块和细节感知上下文注意 (DCA)模块。首先，将从编码器网络 (ResNet-18 He et al, 2016)中提取的多尺度特征{Fi}5 i=1 输入到 CFF 模块中，引入跨层融合策略，促进不同尺度特征之间的信息交换，得到增强特征{FiC}5 i=1。之后，将 SFE 模块和 DCA 模块分别部署在高层特征{FiC}5 i=3 中，低层特征{FiC}2 i=1 中。具体而言，为了对语义描述进行充分的探索，我们使用了 SFE 模块，该模块利用了 F3 C 和 F4 C 之间的相关性来生成深层语义特征 F𝑆。然后，DAC 模块采用分离注意机制，对空间细节给予更多关注，滤除背景噪声，得到细节感知特征{Fi𝐷}2 i=1。最后，通过将所有模块的输出以自上而下的方式组合在一起，我们可以生成最终的显著性图 S。
![[Pasted image 20240612141157.png]]

**3.3. 语义感知特征提取模块**
现有的方法大多试图挖掘语义信息来指示缺陷的位置，然而，其中一些方法 (Zhang et al .， 2020 b; Dong et al .， 2021 a)忽略了特征之间的相关性。受 Zhang et al .(2019)和 Li et al .(2022)的启发，我们尝试通过探索 F3 C 和 F4 C 之间的相关性来提取全局线索。同时，我们发现该研究 (Li et al, 2022)只在空间维度上生成一个单一的关联矩阵来引导两个输入特征，而忽略了通道维度上的特征交互，而通道维度在高级特征上更值得关注。因此，我们提出了一种语义感知特征提取 (SFE)模块，其中生成两个交互矩阵来同时学习通道和空间维度上的互补关系。如图 3 所示，语义感知特征提取 (SFE)模块包括两个阶段，即特征交互 (橙色部分)和特征细化 (蓝色部分)。

![[Pasted image 20240612141748.png]]

**3.3.1. 交互功能**
![[Pasted image 20240612141816.png]]



![[1-s2.0-S0952197623006589-main.pdf]]